## 登录相关

### 首先进入一个空白页面（blank页面），调用接口获取用户的基本信息
（其中的一些逻辑跳转都封装在common下的SceneValueStrategy和MPCodeStrategy中）
  + 根据基本信息中的stage判断用户是否注册
    + 如果stage为0，是未注册用户，然后再判断场景值
      + 场景值为1007、1008是从分享小程序卡片进入的
        + 获取分享小程序卡片的信息
          + 如果是未激活的卡片，跳转到同意书页面（index页面），并携带卡片信息relationId，进行下一步操作
          + 如果是已激活的卡片，跳转到无效页面（invalid页面），告知用户卡片已被激活
          + 如果是其他错误信息，跳转到无效页面（invalid页面）,并告知用户错误原因
      + 场景值为1037是从其他小程序进入的
        + 获取从其他小程序跳转过来携带的参数，调用校验的参数的接口
          + 如果参数正常，跳转到同意书页面（index页面），并携带小程序参数的信息，进行下一步操作
          + 如果参数异常，跳转到无效页面（invalid页面）,并告知用户错误原因
      + 场景值为1047、1048、1049是通过扫描小程序码进入的
        + 如果场景值有效，然后判断用户渠道（保险公司渠道，京东渠道，intellisure渠道，京东安联渠道）
          + 如果渠道为保险公司的，跳转到同意书页面（index页面），并携带小程序码信息，进行下一步操作
          + 其他渠道都为家庭账号，统一处理
            + 首先判断小程序码类型type
              + type为1，查看status是否核销
                + status为1的代表未核销，跳转到同意书页面（index页面），进行下一步操作
                + status为2的代表已核销，跳转到无效页面（invalid页面）,并告知用户小程序码已被核销
              + type为2的代表账号尚未激活
                + 跳转到无效页面（invalid页面）,并告知用户“尚未激活请点击家属分享的卡片进行激活”
              + 其他type统一按照保险公司的处理
                + 跳转到同意书页面（index页面），进行下一步操作
        + 如果场景值无效或者接口报错，跳转到无效页面（invalid页面），并告知用户无效页面
      + 场景值为其他的，都统一处理为其他入口进入
        + 其他场景值进入的还未对外开放，统一跳转到无效页面（invalid页面）,并告知用户“您还未注册，请扫码或从分享卡片进入”
    + 如果stage不为0，是注册过的用户，然后再判断是否是未激活的家庭患者
      + 根据基本信息中的userType,userSubType判断用户类型
        + 如果都为2，并且memberId不存在，是未激活的家庭患者账号，跳转到家庭患者卡片页面（familyAccount页面）
        + 其他情况，都跳转到首页（home页）
          + 其他情况分为1.是MVP版本的患者
          + 2.自用患者
          + 3.家庭主中激活的家庭患者
### 同意书页面（index页面）针对携带的参数信息，做不同处理
  + 点击同意书中的下一步，授权手机号信息
    + 授权
      + 如果是itellisure渠道，获取员工信息，查看手机号是否匹配
        + 如果匹配，跳转到家庭账号列表页面（accountList页面）
        + 如果不匹配，跳转到无效页面（invalid页面）,并告知用户手机号不匹配
      + 如果是京东安联渠道
        + 获取京东安联的用户信息，存储到缓存中，跳转到家庭账号列表页面（accountList页面）
        + 获取信息失败，跳转到无效页面（invalid页面）,并告知用户错误原因
      + 如果是家庭主用户，跳转到家庭账号列表页面（accountList页面）
      + 如果是分享卡片进来的用户，跳转到激活页面（activationFamilyCode页面），进行激活
      + 如果是从其他小程序进来的用户，要查看手机号是否匹配
        + 如果匹配，跳转到家庭主中的患者注册页面（patientInfo）
        + 如果不匹配，跳转到无效页面（invalid页面）,并告知用户手机号不匹配
    + 拒绝授权
      + 如果是itellisure，京东安联，分享卡片，其他小程序进入的，跳转到手机号需要认证页面（phoneNotMatch页面），告诉用户“跳转到系统需要您的手机号认证身份，否则无法享受系统服务”
      + 如果是家庭主用户，跳转到家庭账号列表页面（accountList页面）
      + 如果是其他方式进入的，统一跳转到注册用户页面（userInfo页面）


### 一些参数枚举值含义
+ stage
  + 0-未填写注册信息；
  + 1-已填写注册信息；
  + 2-入组失败；
  + 3-入组成功；
  + 4-已确认收货地址；
  + 8-已寄送BGM设备；
  + 16-已完成首日问诊；
  + 32-已寄送Glarlink；
  + 64-已完成入组教育(用二进制位表示)
+ channel
  + 0-保险公司
  + 1-JD
  + 2-intellisure
  + 3-国药
  + 4-京东安联
+ userType
  + 1-普通账号
  + 2-家庭账号
  + 3-国药账号
  + 4-京东安联账号
+ userSubType
  + 1-自用
  + 2-家庭主
  + 3-家庭患者
+ status
  + 1-未核销；
  + 2-已核销；
+ sceneSource 二维码来源
  + 0-保险公司
  + 1-JD
  + 2-intellisure
  + 4-京东安联